# Massachusetts General Hospital Data Analysis Project
## Project Background
[Massachusetts General](http://massgeneral.org/about/) or MGH is the original and largest teaching hospital of Harvard Medical School located in the West End neighborhood of Boston, Massachusetts. It is the third oldest general hospital in the United States and has a capacity of 999 beds. Currently, MGH captures and stored patient information in electronic health records (EHRs). An EHR is an electronic system used and maintained by healthcare systems to collect and store patientsâ€™ medical information.

----

## Table of Contents
1. [Projective Objective](#projective-objective)
2. [Project Hypotheses](#project-hypotheses)
3. [Data Source and Description](#data-source-and-description)
4. [Tools](#tools)
5. [Data Cleaning and Preparation](#data-cleaning-and-preparation)
6. [Exploratory Data Analysis](#exploratory-data-analysis)
7. [Data Analysis](#data-analysis)
8. [Findings](#findings)
9. [Recommendations](#recommendations)
10. [Limitations](#limitations)
11. [References](#references)
  
---
## Projective Objective
To analyze data derived from the Eletronic Health Records (EHR) of the hospital in order to to provide insights that will enable the hospital's stakeholders make data driven decisions.

----

## Project Hypotheses
**1. Oraganizations and Location**
   - **Null hypothesis:** There is no significant difference in revenue generated by organizations located in affluent areas of Massachusetts and organizations located in lower-income neighborhoods
   - **Alternative Hypothesis:** There is a significant difference in revenue generated by organizations located in affluent areas of Massachusetts and organizations located in  lower-income. implying that organizations situated in wealthier neighborhoods may attract       patients with better insurance coverage or ability to pay out-of-pocket for medical services, leading to higher revenue generation compared to hospitals in economically disadvantaged areas.
     
**2. Organization Utilization and Location**
   - **Null hypothesis:** There is no significant difference in facility utilization rates between densely populated areas of Massachusetts and organizations in suburban or rural areas
   - **Alternative Hypothesis:** organizations located in urban centers face higher demand for healthcare services due to the concentration of population, resulting in more frequent use of organizations facilities such as emergency rooms, inpatient beds, and outpatient clinics compared to organizations in less populated areas.

**3. Healthcare coverage and the White Race**
   - **Null Hypothesis:** There is no correlation between the white race and healthcare coverage.
   - **Alternative Hypothesis:** white have more healthcare coverage than other races suggesting that whites have more access to healthcare than other races.

**4. Healthcare coverage and gender**
   - **Null Hypothesis:** There is no significant relationship between healthcare coverage and gender. All genders have equal access to healthcare coverage.
   - **Alternative Hypothesis:** There is a significant relationship between health coverage and gender where males have more access to healthcare coverage than females.

  ------

## Data Source and Description
The data used in this analysis was derived from the hospital's Electronic Health Records(EHR) provided in CSV files. 

Here are the data files provided:

**1. Patients** - This table containesl the details of the each patient who visited the hospital.  The details captured include Inique ID, names, date of birth, Social Security Number, Passport Number, Birth Date, Death Date, Maiden name, Race, Marital Status, birth place etc. 

**2. Encounters** - This data captures each hospital visit called an encounter. It captures a unique ID, start and end of the encounter, Duration, Patients Age, name, Birth Date, Death Date, Gender, Marital Status, Patients Coverage, Hospital Name etc. This is the main table that brings together data from all the other tables.

**3. Providers** - This date captures the details of the health care provider. It captures Hospital Name, City, Doctor's Name, Gender, Speciality etc

**4. Payers** - This data captures details of insurance provider

**5. Payer_transitions** - This file captures data that links patients data and the insurance providers data

**6. Organizations** - This file captures data of the healthcare facility

You can find full dataset used here - [Dataset](https://github.com/Irene-Chola/Massachusetts-General-Hospital-Data-Analysis-Project/blob/main/MGHExcel.Dashboard.jpeg) 
   
-----
## Tools
- Excel - Data cleaning
- Alteryx - Data cleaning
- Python - Data cleaning
- MySQLWorkbench - Data Analysis
- PowerBI - Dashboarding
-----
## Data Cleaning and Preparation
Various tools where used for data cleaning and preparation.

**1. Alteryx**

[Data Cleaning in Alteryx](https://github.com/Irene-Chola/Massachusetts-General-Hospital-Data-Analysis-Project/blob/main/ConsolidateAlteryx.datacleaning.yxmd)

Alteryx was used to clean the data. It came in handy in changing the data types of all the fields, removing unwanted characters in the patients names etc. One significant data cleaning step in Alteryx was changing the date type of the Patients file.

**2. Python**

[Python Code](https://github.com/Irene-Chola/Massachusetts-General-Hospital-Data-Analysis-Project/blob/main/calculateage.ipynb)

Python also came in handy in data cleansing when all the other tools were challenged to calculate the age of the patients.

**3. Excel**

[Excel Data Cleaning](https://github.com/Irene-Chola/Massachusetts-General-Hospital-Data-Analysis-Project/blob/main/MGHExcel.Dashboard.jpeg)

Once all the files were clean, a master excel workbook was created. The clean CSV files were converted to Excel files and added as sheets in the master file.
The Master File was then loaded to Power Query for further analysis, manipulation and cleaning. 
The encounters sheet was used as the main sheet. Joins were performed in Power Query to bring in Patients Details, Payers details, Organizations details and Providers details.

Various conditional and custom columns were added such as age groups, age of patients, number of years covered and length of encounters in minutes

----
## Exploratory Data Analysis
- For each City in Massachussets, what is the total revenue generated, number of organizations and facility utilization?
- What is the distribution of patients by gender?
- what is the distribution of providers by gender?
- What is the marital status by healthcare coverage?
- What is the count of Providers speciality?
- What is comparison betweent the total health care expeses and health care coverage?
- What is the count of each patient encounter class?
- What is the race of the patients?
- What is the percentage of healthcare coverage by gender?
- List of patients under different healthcare providers
  
----
## Data Analysis
EDA was done in MySQLWorkbench. Here are some examples of queries that were used to analyse the date.

1. This code was used to classify the patients into various age groups.
```S\select concat(FIRST_NAME, ' ', LAST_NAME) Full_Name, AGE,
CASE
    WHEN AGE >= 0 AND AGE <= 3 THEN 'Baby'
    WHEN AGE > 3 AND AGE <= 8 THEN 'Todler'
    WHEN AGE > 8 AND AGE <= 18 THEN 'Minor'
    WHEN AGE > 18 AND AGE <= 35 THEN 'Young Adult'
    WHEN AGE > 35 AND AGE <= 55 THEN 'Senior Adult'
    WHEN AGE > 55 AND AGE <= 70 THEN 'Upper Middle Age'
    WHEN AGE > 70 THEN 'Senior Citizen'
END AS AGE_GROUP
FROM mghmedicaldata.patients
ORDER BY Full_Name;
```

2. This is an example of a stored procedure that was created to retrieve the details of all patients under an a particular healthcare provider

```
delimiter $$

CREATE PROCEDURE mghmedicaldata.Insurance_Provider(IN Insurer_Name TEXT)
BEGIN
  SELECT  PD.NAME Name_of_Insurer, P.FIRST_NAME, P.LAST_NAME, PT.START_YEAR, PT.END_YEAR, PT.YEARS_COVERED, PT.OWNERSHIP, PD.AMOUNT_COVERED, PD.AMOUNT_UNCOVERED
  FROM patients P
  JOIN mghmedicaldata.payer_transitions PT
  ON P.Id = PT.PATIENT
  JOIN payers PD
  ON PT.PAYER = PD.Id
        
WHERE PD.NAME = Insurer_Name;
END $$ 
```
3. This sql code was used to classify the data by encounter class, give a total of each encounter class, and the cost of each encounter class
```
SELECT ENCOUNTER_CLASS, count(Id) TOTAL_ENCOUNTERS, round(sum(BASE_ENCOUNTER_COST),2) TOTAL_ENCOUNTER_COST
FROM mghmedicaldata.encounters
GROUP BY ENCOUNTER_CLASS;
````
Here is a list a comprehensive list of queries that was used for data analysis

[SQL Queries and stored Procedures](https://github.com/Irene-Chola/Massachusetts-General-Hospital-Data-Analysis-Project/blob/main/Consolidatedqueries.sql)

----
## Dashboards
[Tableau Dashboard](https://public.tableau.com/app/profile/irene.chola/viz/MGHmedicalDataDashboard/Dashboard1?publish=yes)

[Excel Dashboard](https://github.com/Irene-Chola/Massachusetts-General-Hospital-Data-Analysis-Project/blob/main/MGHExcel.Dashboard.jpeg)

## Findings

1. Majority of the population does not have access to healthcare coverage and pay for their healthcare expenses out of pocket.
2. Big cities with higher populations and better incomes have more organizations/hospitals with higher revenues and facility utilization.
3. Males have more access to healthcare coverage compared to females and in the same vein, we have more male healthcare providers than females.
4. The white race has the highest healthcare coverage, higher than all the other races combined.
5. Most people do not disclose their encounter reason. Undisclosed encounter reason has healthcare expenses of over 41B.
6. Encounters have consistently gone up over the years. However a sudden spike in encounters is seen from around 2019, coinciding with the Covid 19 Pandemic.
---

## Recommendations
----
## Limitations
1. Some of the data was incomplete or missing. For example, encounter reasons and marital status.
2. 
-----
## References

